/*!
 * vue-fields v1.0.5
 * https://github.com/pagekit/vue-fields
 * Released under the MIT License.
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VueFields=t()}(this,function(){"use strict";var a,i=!1,u=Object.assign||function(n){var e=[],t=arguments.length-1;for(;0<t--;)e[t]=arguments[t+1];return e.forEach(function(t){Object.keys(t||{}).forEach(function(e){return n[e]=t[e]})}),n},o=Array.isArray;function l(e){"undefined"!=typeof console&&i&&console.log("%c vue-fields %c "+e+" ","color: #fff; background: #35495E; padding: 1px; border-radius: 3px 0 0 3px;","color: #fff; background: #DB6B00; padding: 1px; border-radius: 0 3px 3px 0;")}function s(e){return null!==e&&"object"==typeof e}function c(e){return void 0===e}function d(e,t,n){for(var r=t.split("."),i=0;i<r.length;i++){if(c(e[r[i]]))return n;e=e[r[i]]}return e}function v(e,t,n){for(var r=t.split(".");1<r.length;){var i=r.shift();s(e[i])&&!o(e[i])||a(e,i,{}),e=e[i]}a(e,r.shift(),n)}function f(e,t){var n,r;if("number"==typeof e.length)for(n=0;n<e.length;n++)t.call(e[n],e[n],n);else if(s(e))for(r in e)e.hasOwnProperty(r)&&t.call(e[r],e[r],r);return e}var p={inject:["Fields"],props:{field:{type:Object,required:!0},values:{type:Object,required:!0}},data:function(){return u({name:"",label:"",attrs:{},options:[],default:void 0},this.field)},computed:{value:{get:function(){return d(this.values,this.name)},set:function(e){this.$emit("change",e,this)}},attributes:{get:function(){return this.enable&&!this.Fields.evaluate(this.enable)?u({disabled:"true"},this.attrs):this.attrs}}},created:function(){c(this.value)&&!c(this.default)&&(this.value=this.default)},methods:{filterOptions:function(e){var n=this,r=[];return e?f(e,function(e,t){s(e)?r.push({label:t,options:n.filterOptions(e)}):r.push({text:t,value:e})}):l("Invalid options provided for "+this.name),r}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.fields,function(e){return n("div",{key:e.name},["checkbox"!=e.type?n("label",[t._v(t._s(e.label))]):t._e(),t._v(" "),n(e.component,{tag:"component",attrs:{field:e,values:t.values},on:{change:t.change}})],1)}))},staticRenderFns:[],components:{FieldText:{render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("input",t._b({directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{type:"text"},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}},"input",t.attributes,!1))},staticRenderFns:[],extends:p},FieldTextarea:{render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("textarea",t._b({directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}},"textarea",t.attributes,!1))},staticRenderFns:[],extends:p},FieldRadio:{render:function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",[n._l(n.filterOptions(n.options),function(t){return[r("input",n._b({directives:[{name:"model",rawName:"v-model",value:n.value,expression:"value"}],attrs:{name:n.name,type:"radio"},domProps:{value:t.value,checked:n._q(n.value,t.value)},on:{change:function(e){n.value=t.value}}},"input",n.attributes,!1)),n._v(" "),r("label",[n._v(n._s(t.text))])]})],2)},staticRenderFns:[],extends:p},FieldCheckbox:{render:function(){var a=this,e=a.$createElement;return(a._self._c||e)("input",a._b({directives:[{name:"model",rawName:"v-model",value:a.value,expression:"value"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.value)?-1<a._i(a.value,null):a.value},on:{change:function(e){var t=a.value,n=e.target,r=!!n.checked;if(Array.isArray(t)){var i=a._i(t,null);n.checked?i<0&&(a.value=t.concat([null])):-1<i&&(a.value=t.slice(0,i).concat(t.slice(i+1)))}else a.value=r}}},"input",a.attributes,!1))},staticRenderFns:[],extends:p},FieldSelect:{render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("select",n._b({directives:[{name:"model",rawName:"v-model",value:n.value,expression:"value"}],on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});n.value=e.target.multiple?t:t[0]}}},"select",n.attributes,!1),[n._l(n.filterOptions(n.options),function(e){return[e.label?t("optgroup",{attrs:{label:e.label}},n._l(e.options,function(e){return t("option",{domProps:{value:e.value}},[n._v(n._s(e.text))])})):t("option",{domProps:{value:e.value}},[n._v(n._s(e.text))])]})],2)},staticRenderFns:[],extends:p},FieldRange:{render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("input",t._b({directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{type:"range"},domProps:{value:t.value},on:{__r:function(e){t.value=e.target.value}}},"input",t.attributes,!1))},staticRenderFns:[],extends:p},FieldNumber:{render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("input",t._b({directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{type:"number"},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}},"input",t.attributes,!1))},staticRenderFns:[],extends:p}},provide:function(){return{Fields:this}},props:{config:{type:[Object,Array],default:function(){}},values:{type:Object,default:function(){}},prefix:{type:String,default:"field-"}},computed:{fields:function(){return this.prepare()}},methods:{change:function(e,t){v(this.values,t.name,e),c(e)||this.$emit("change",e,t)},evaluate:function(e,r,t){if(void 0===r&&(r=this.values),void 0===t&&(t=this.config),"string"==typeof e){var i={$match:n,$values:r};return f(t,function(e,t){var n=e.name;return void 0===n&&(n=t),v(i,n,d(r,n))}),function(e,t,n){try{return Function("c","with(c){return "+t+"}").call(e,n)}catch(e){l(e)}return!1}(this,e,u(i,r))}return e.call(this,r,this)},prepare:function(e,n){var r=this;void 0===e&&(e=this.config),void 0===n&&(n=this.prefix);var i=o(e),a=[];return f(e,function(e,t){(e=u({},e)).name||i||(e.name=t),e.name?(e.type||(e.type="text"),e.component||(e.component=n+e.type),e.show&&!r.evaluate(e.show)||a.push(e)):l("Field name missing "+JSON.stringify(e))}),a}}};function n(e,t,n){return e&&new RegExp(t,n).test(e)}function h(e){var t,n,r;h.installed||(n=(t=e).set,r=t.config,a=n,i=r.debug||!r.silent,e.component("field",p),e.component("fields",m))}return h.Field=p,h.Fields=m,"undefined"!=typeof window&&window.Vue&&window.Vue.use(h),h});