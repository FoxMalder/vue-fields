/*!
 * vue-fields v1.0.0
 * https://github.com/pagekit/vue-fields
 * Released under the MIT License.
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VueFields=t()}(this,function(){"use strict";var e,t=!1,n=Array.isArray;function r(e){"undefined"!=typeof console&&t&&console.warn("[VueForm warn]: "+e)}function i(e){return null!==e&&"object"==typeof e}function a(e){return void 0===e}function u(e,t,n){var r,i=t.split(".");for(r=0;r<i.length;r++){if(a(e[i[r]]))return n;e=e[i[r]]}return e}function l(e,t){var n,r;if("number"==typeof e.length)for(n=0;n<e.length;n++)t.call(e[n],e[n],n);else if(i(e))for(r in e)e.hasOwnProperty(r)&&t.call(e[r],e[r],r);return e}var o=Object.assign||function(e){for(var t=arguments,n=1;n<arguments.length;n++){var r=t[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},s={inject:["fields"],props:{field:{type:Object,required:!0},values:{type:Object,required:!0}},data:function(){return o({name:"",label:"",attrs:{},options:[],default:void 0},this.field)},computed:{value:{get:function(){return u(this.values,this.name)},set:function(e){this.$emit("change",this,e)}},attributes:{get:function(){return this.enable&&!this.fields.evaluate(this.enable)?o({disabled:"true"},this.attrs):this.attrs}}},created:function(){a(this.value)&&(this.value=this.default)},methods:{filterOptions:function(e){var t=this,n=[];return e?(l(e,function(e,r){i(e)?n.push({label:r,options:t.filterOptions(e)}):n.push({text:r,value:e})}),n):(r("Invalid options provided for "+this.name),n)}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._l(e.fields,function(t){return n("div",{key:t.name},["checkbox"!=t.type?n("label",[e._v(e._s(t.label))]):e._e(),e._v(" "),n(t.component,{tag:"component",attrs:{field:t,values:e.values},on:{change:e.change}})],1)}))},staticRenderFns:[],components:{FieldText:{render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{type:"text"},domProps:{value:e.value},on:{input:function(t){t.target.composing||(e.value=t.target.value)}}},"input",e.attributes,!1))},staticRenderFns:[],extends:s},FieldTextarea:{render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("textarea",e._b({directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],domProps:{value:e.value},on:{input:function(t){t.target.composing||(e.value=t.target.value)}}},"textarea",e.attributes,!1))},staticRenderFns:[],extends:s},FieldRadio:{render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._l(e.filterOptions(e.options),function(t){return[n("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{type:"radio",name:e.name},domProps:{value:t.value,checked:e._q(e.value,t.value)},on:{change:function(n){e.value=t.value}}},"input",e.attributes,!1)),e._v(" "),n("label",[e._v(e._s(t.text))])]})],2)},staticRenderFns:[],extends:s},FieldCheckbox:{render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.value)?e._i(e.value,null)>-1:e.value},on:{change:function(t){var n=e.value,r=t.target,i=!!r.checked;if(Array.isArray(n)){var a=e._i(n,null);r.checked?a<0&&(e.value=n.concat([null])):a>-1&&(e.value=n.slice(0,a).concat(n.slice(a+1)))}else e.value=i}}},"input",e.attributes,!1))},staticRenderFns:[],extends:s},FieldSelect:{render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("select",e._b({directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.value=t.target.multiple?n:n[0]}}},"select",e.attributes,!1),[e._l(e.filterOptions(e.options),function(t){return[t.label?n("optgroup",{attrs:{label:t.label}},e._l(t.options,function(t){return n("option",{domProps:{value:t.value}},[e._v(e._s(t.text))])})):n("option",{domProps:{value:t.value}},[e._v(e._s(t.text))])]})],2)},staticRenderFns:[],extends:s},FieldRange:{render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{type:"range"},domProps:{value:e.value},on:{__r:function(t){e.value=t.target.value}}},"input",e.attributes,!1))},staticRenderFns:[],extends:s},FieldNumber:{render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{type:"number"},domProps:{value:e.value},on:{input:function(t){t.target.composing||(e.value=t.target.value)}}},"input",e.attributes,!1))},staticRenderFns:[],extends:s}},provide:function(){return{fields:this}},props:{config:{type:[Object,Array],required:!0},values:{type:Object,default:function(){}},prefix:{type:String,default:"field-"}},computed:{fields:function(){var e=this,t=n(this.config),i=[];return l(this.config,function(n,a){(n=o({},n)).name||t||(n.name=a),n.name?(n.type||(n.type="text"),n.component||(n.component=e.prefix+n.type),n.show&&!e.evaluate(n.show)||i.push(n)):r("Field name missing "+JSON.stringify(n))}),i}},methods:{change:function(t,r){var l=u(this.values,t.name);!function(t,r,a){for(var u,l=r.split(".");l.length>1;)i(t[u=l.shift()])&&!n(t[u])||e(t,u,{}),t=t[u];e(t,l.shift(),a)}(this.values,t.name,r),a(r)||this.$emit("change",t,r,l)},evaluate:function(e,t){if(t=t||this.values,"string"==typeof e)return function(e,t){try{return Function("with(this){return "+e+"}").call(t)}catch(e){return!1}}(e,o({$match:v},t));return e.call(this,t,this)}}};function v(e,t,n){return e&&new RegExp(t,n).test(e)}function d(n){if(!d.installed){e=(r=n).set,t=r.config.debug||!r.config.silent;var r;n.component("field",s),n.component("fields",c)}}return d.Field=s,d.Fields=c,"undefined"!=typeof window&&window.Vue&&window.Vue.use(d),d});